% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Functions.R
\name{cut_cells}
\alias{cut_cells}
\title{Filter Cells Based on Multiple Cut-off Criteria}
\usage{
cut_cells(
  meta,
  percentMT_cut = 10,
  percentMT_type = "greater",
  percentERCC_cut = 25,
  percentERCC_type = "greater",
  percentPC_cut = 75,
  percentPC_type = "smaller",
  percentrRNA_cut = 2,
  percentrRNA_type = "greater",
  nFeature_RNA_cut = 1000,
  nFeature_RNA_type = "smaller",
  gene_count_cut = 1000,
  gene_count_type = "smaller",
  n.sd = 2,
  plate = NULL
)
}
\arguments{
\item{meta}{A data frame containing cell metadata, with row names representing cell IDs.}

\item{percentMT_cut}{Numeric value for the mitochondrial percentage threshold (default is 4).}

\item{percentMT_type}{Character indicating filtering direction for mitochondrial percentage ("greater" to filter cells with values above the cut-off; default is "greater").}

\item{percentERCC_cut}{Numeric value for the ERCC percentage threshold (default is 3).}

\item{percentERCC_type}{Character indicating filtering direction for ERCC percentage ("greater"; default is "greater").}

\item{percentPC_cut}{Numeric value for the percentPC threshold (default is 90).}

\item{percentPC_type}{Character indicating filtering direction for percentPC ("smaller" filters cells with values below the threshold; default is "smaller").}

\item{percentrRNA_cut}{Numeric value for the rRNA percentage threshold (default is 2).}

\item{percentrRNA_type}{Character indicating filtering direction for rRNA percentage ("greater"; default is "greater").}

\item{nFeature_RNA_cut}{Numeric value for the number of features threshold (default is 5000).}

\item{nFeature_RNA_type}{Character indicating filtering direction for number of features ("smaller"; default is "smaller").}

\item{n.sd}{Numeric value representing the multiplier for the median absolute deviation (MAD) used to calculate the dynamic threshold when the cut-off is NA (default is 2).}

\item{plate}{Character specifying a plate identifier. Only cells belonging to this plate (i.e. where \code{meta$orig.ident == plate}) will be considered.}

\item{gene_counts_cut}{Numeric value for the UMI counts threshold (default is 5000).}

\item{gene_counts_type}{Character indicating filtering direction for UMI counts ("smaller"; default is "smaller").}
}
\value{
A list with two elements:
\item{filtered}{A vector of cell IDs (row names from \code{meta}) that meet the filtering criteria.}
\item{settings}{A list of final cut-off values used for each metric.}
}
\description{
This function filters cells from a metadata data frame by applying thresholds on several metrics.
If a given cut-off is NA, the function calculates a dynamic threshold based on the median and MAD
(multiplied by \code{n.sd}) of the metric. The filtering criteria (greater or smaller than the cut-off)
is determined by the associated type.
}
\examples{
\dontrun{
  # Example usage:
  # Assume 'meta' is a data frame with the necessary columns.
  result <- cut.cells(meta, plate = "Plate1")
  print(result$filtered)
  print(result$settings)
}

}
